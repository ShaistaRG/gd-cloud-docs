<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">

<head>


<title>Install and configure Ghost with NGINX - Ubuntu, Debian</title>
<style type='text/css'>
div.hacker {
background-color:#666;
border:1px solid #ccc;
color:#fff;
font-family:"Lucida Console","Courier New",Courier,fixed;  font-size:95%;  line-height:160%;  margin-bottom:1.5em;  padding:10px; }

p.note {
 background-color:#ffffe6;
 border:1px solid #eee;
 color:#666;
 padding:.8em 1.6em;
 margin:15px 0;
}

.warning {
 border: 1px #d25100 solid;
 padding: .5em 1em .5em 4em;
 margin: 10px 20px 15px 20px;
 background-image: url('@{help-img-path}/img_warning.gif');
 background-repeat: no-repeat;
 background-position: left top;
 background-color: #ededed;-moz-border-radius:
0.8em;-webkit-border-radius: 0.8em;
 /* -moz-border-bottom-radius: 0;9 */
 -webkit-border-bottom-radius: 0;
 padding-top:14px;
 padding-bottom:15px;
}
</style>


<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:ArticleKeywords msdt:dt="string">CMS, Ghost, NGINX</mso:ArticleKeywords>
<mso:Reference msdt:dt="string">https://www.digitalocean.com/community/tutorials/how-to-host-ghost-with-nginx-on-digitalocean, https://www.digitalocean.com/community/tutorials/how-to-host-ghost-with-nginx-on-digitalocean</mso:Reference>
<mso:LinuxDistributions msdt:dt="string">;#Ubuntu;#Debian;#</mso:LinuxDistributions>
<mso:ArticlePriority msdt:dt="string">4</mso:ArticlePriority>
<mso:RequestNotes msdt:dt="string"></mso:RequestNotes>
<mso:Difficulty msdt:dt="string">2</mso:Difficulty>
<mso:ForkSplit msdt:dt="string"></mso:ForkSplit>
<mso:ArticleID msdt:dt="string">18132</mso:ArticleID>
<mso:UnsupportedFeatures msdt:dt="string"></mso:UnsupportedFeatures>
<mso:Collapsed msdt:dt="string"></mso:Collapsed>
<mso:Complexity msdt:dt="string"></mso:Complexity>
<mso:ArticleStatus msdt:dt="string">Not started</mso:ArticleStatus>


<mso:Sample msdt:dt="string">z</mso:Sample>
<mso:DeliveryTarget msdt:dt="string"></mso:DeliveryTarget>
<mso:EditScore msdt:dt="string"></mso:EditScore>
<mso:PrereqOrdering msdt:dt="string">2</mso:PrereqOrdering>
<mso:AssignedTo1 msdt:dt="string">12</mso:AssignedTo1>
<mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_AssignedTo1 msdt:dt="string">Tom Taylor</mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_AssignedTo1>
</mso:CustomDocumentProperties>
</xml><![endif]-->
</head>

<body>
<p>Install and configure Ghost with NGINX - Ubuntu, CMS, Ghost, NGINX</p>
    <h1>Install and Configure Ghost with Nginx - Ubuntu</h1>
    
    <p><strong>Difficulty</strong>: <em>2</em><br/>
        <strong>Time</strong>: <em>1.0 hrs</em></p>

    <p>Ghost is simple blogging platform that is fast and easy to set up and provides good customization options. This article  will help you  to set up a Ghost blogging platform with Nginx on  Ubuntu. </p>
<p class="note">These procedures assume that you are logged in as a root user.</p> 

    <h2>Prepare the machine</h2>
    To perform the following tasks, make sure that you have  root or sudo user privileges.
    <ol>
	<li>Update your Ubuntu server. (For the interactive installations, you might need to respond regarding the confirmation for installation.<!--"might" is confusing. Can we provide something more definite? Also, what are the interactive installations? cj-->)
	  <div class='hacker'>apt-get update</div>
	<div class='hacker'>apt-get upgrade</div>
    </li>
	
	<li>Install dependencies, including <code>python</code> and <code>nodejs</code>.
	  <div class='hacker'>apt-get install unzip</div>
	<div class='hacker'>apt-get install python-software-properties python g++ make</div>
	<div class='hacker'>add-apt-repository ppa:chris-lea/node.js</div>
	<div class='hacker'>apt-get update</div>
	<div class='hacker'>apt-get install nodejs</div>
    </li>
	</ol>
	
	<h2>Install and configure Ghost</h2>
    <ol>
	<li>Download the latest version of Ghost from   <code>Ghost.org</code>.
<div class='hacker'>curl -L https://ghost.org/zip/ghost-latest.zip -o ghost.zip</div>
	</li>
	<li>Unzip the file to a suitable folder location such as <code>/var/www/ghost</code>.
      <div class='hacker'>mkdir –p /var/www</div>
	<div class='hacker'>unzip -uo ghost.zip -d /var/www/ghost</div>
    </li>
	
	<li>Install  Ghost in the new <code>ghost</code> directory.
<div class='hacker'>cd /var/www/ghost &amp;&amp; npm install --production</div>
    </li>
	<li>Start  Ghost (production environment).
	  <div class='hacker'>npm start --production</div>
	The default port used by Ghost is 127.0.0.1:2368.
	<p>When  starting, Ghost displays the message “Your blog is now available on <code> http://<em><u>provided URL</u></em>.</code>&quot; You can update this URL value  in the configuration file <code>config.js.</code></p>
   
	<img src="images/18132-Ubuntu-GhostServerStart.png" alt="18132-Ubuntu-GhostServerStart.png"/> </li>
	</ol>
	
<h2>Install and configure Nginx</h2>
Nginx is used to enable connections from the outside on port 80 to connect through to the port that Ghost is running on, so that people can see your blog.
    <ol>
	<li>Install Nginx.
	  <div class='hacker'>apt-get install nginx</div>
	</li>
	<li>Remove all the default files.
	  <div class='hacker'>cd /etc/nginx/</div>
	<div class='hacker'>rm sites-enabled/default</div>
    </li>
	
	<li>Create a new Ghost configuration file.<!--and open it for editing? cj-->
      <div class='hacker'>cd sites-available</div>
	<div class='hacker'>vi ghost</div>
    </li>
	<li>Put the following code into the file, modifying it to adapt to your own configuration (The only thing you should need to change is the domain name<!--Variables need to use proper formatting. cj -->):
	  <div class='hacker'><pre>
server {
    listen 0.0.0.0:80;
    server_name http://192.169.171.249;
    access_log /var/log/nginx/192.169.171.249.log;

    location / {
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header HOST $http_host;
        proxy_set_header X-NginX-Proxy true;

        proxy_pass http://127.0.0.1:2368;
        proxy_redirect off;
    }
}
		</pre></div>
	</li>
	
	<li>Create a symlink from the file in <code>sites-available</code> to <code>sites-enabled</code>.
<div class='hacker'>cd ..</div>
	<div class='hacker'>ln -s sites-available/ghost sites-enabled/ghost</div>
    </li>
	
	<li>Open the Ghost configuration file <code>/var/www/ghost/config.js</code> for editing.
      <div class='hacker'>vi /var/www/ghost/config.js</div>
    </li>
	
	<li>Put the following code into the Ghost configuration file (content highlighted in red needs to be updated).<!--There is no red text. Also, variables need to be formatted with em and u tags. cj--> The URL can be your domain name (http://<em><u>your-domainname</u></em>.com) or the public IP address of your droplet.
<div class='hacker'><pre>
	production: {
        url: 'http://192.169.171.249',
        mail: {},
        database: {
            client: 'sqlite3',
            connection: {
                filename: path.join(__dirname, '/content/data/ghost.db')
            },
            debug: false
        },

        server: {
            // Host to be passed to node's `net.Server#listen()`
            host: '192.169.171.249',
            // Port to be passed to node's `net.Server#listen()`, for iisnode set this to `process.env.PORT`
            port: '2368'
        }
    }
</pre></div>
    </li>
	
	<li>Start  Ghost (production environment).
	  <div class='hacker'>cd /var/www/ghost </div>
	<div class='hacker'>npm start --production</div>
    </li>
	
	<li>In your browser, open the page (red highlighted text <!--No red text. cj -->needs to be updated). The Ghost blog should be available  via the specified URL. 
<br/>
<p><code>http://192.169.171.249:2368/ </code></p>
<img src="images/18132-Ubuntu-GhostOnBrowser.png" alt="18132-Ubuntu-GhostOnBrowser"/>
	</li>
</ol>
<h2>Configure Upstart</h2>
	Once the Ghost blog is up and running, you can create an Upstart task to handle  Ghost.  In case the server gets turned off, the Upstart task ensures that Ghost kicks back on. 
    <ol>
	<li>Create a new Upstart configuration file, and open it for editing.
	  <div class='hacker'>cd /etc/init</div>
	<div class='hacker'>vi ghost.conf</div>
	</li>
	<li>Put the following code into the configuration file:<!--This code is copied from the Digital Ocean article. Please use something original. cj -->
	  <div class='hacker'>
	<pre>
# ghost

# description "An Upstart task to make sure that my Ghost server is always running"
# author "Your Name Here"

start on startup

script
cd /var/www/ghost 
npm start --production
end script
</pre></div>
    </li>
	
	<li>Save and exit by pressing <strong>Esc</strong> and <strong>:wq</strong></li>
	
	</ol>
<p>This  ensures that Ghost  starts whenever your server does and allows you to easily control Ghost using service <code>ghost start</code>, <code>service ghost stop</code>, and <code>service ghost restart</code>.
<!--This sentence is  very close to the Digital Ocean article. If this is important information, how about moving it into the section intro and rearranging it. cj --> </code></p>	
	      
    <h2>Conclusion</h2>
<p> The Ghost blogging platform, with its ease of deployment and use, can help individuals and organizations setup and extend their content management infrastructure. When used with nginx, and with availability of options for setting up and supporting multiple environments like production, development or testing, it can be easily adapted for any environment. <!--This conclusion does not follow the ed guidelines. Please revise. Per ed guidelines, this section should:
"Provide a brief synopsis of what user just completed; Provide direction for user to complete a related task (For help determining an appropriate link for another task, use your discretion/expertise.)"
 cj -->
</p>
</body>
</html>